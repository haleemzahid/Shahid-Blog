{{ define "main" }}
<article class="h-entry">
    <!-- Breadcrumb -->
    <nav style="margin-bottom: 2rem; color: #666; font-size: 0.875rem;">
        <a href="/subjects" style="color: inherit;">Subjects</a> /
        <a href="{{ .Parent.Permalink }}" style="color: inherit;">{{ .Parent.Title }}</a> /
        <span>{{ .Title }}</span>
    </nav>

    <!-- Header -->
    <header class="hero">
        <span class="category p-category">{{ .Parent.Title | upper }}</span>
        <h1 class="p-name">{{ .Title }}</h1>
        <time class="post-date dt-published" datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
            {{ .Date.Format "Monday, January 2, 2006" }} ‚Ä¢ {{ .Params.classTime }}
        </time>
        {{ if .Params.topics }}
        <div class="quick-nav" style="margin-top: 1rem;">
            {{ range .Params.topics }}
            <span class="key-point">{{ . }}</span>
            {{ end }}
        </div>
        {{ end }}
    </header>

    <!-- Videos Section - Full Width -->
    {{ if .Params.videos }}
    <section style="margin: 3rem 0;">
        <div class="content-container">
            <h2 style="font-size: 1.75rem; font-weight: 600; margin-bottom: 2rem;">üìπ Video Recordings</h2>
        </div>
        <div style="max-width: 1200px; margin: 0 auto; padding: 0 2rem;">
            <div style="display: grid; gap: 2rem;">
                {{ range $video := .Params.videos }}
                <div style="border: 1px solid #e5e5e5; border-radius: 4px; overflow: hidden;">
                    <div style="position: relative; padding-bottom: 56.25%; height: 0; background: #000;">
                        <iframe
                            src="{{ $video.url }}"
                            frameborder="0"
                            allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                            allowfullscreen
                            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;">
                        </iframe>
                    </div>
                    <div style="padding: 1rem; border-top: 1px solid #e5e5e5;">
                        <strong>{{ $video.title }}</strong>
                        {{ if $video.duration }}<span style="color: #666; margin-left: 0.5rem;">‚Ä¢ {{ $video.duration }}</span>{{ end }}
                    </div>
                </div>
                {{ end }}
            </div>
        </div>
    </section>
    {{ end }}

    <!-- Audio Section - Full Width -->
    {{ if .Params.audio }}
    <section style="margin: 3rem 0;">
        <div class="content-container">
            <h2 style="font-size: 1.75rem; font-weight: 600; margin-bottom: 2rem;">üéµ Audio Recordings</h2>
        </div>
        <div style="max-width: 1200px; margin: 0 auto; padding: 0 2rem;">
            <div style="display: grid; gap: 1.5rem;">
                {{ range $audio := .Params.audio }}
                <div style="border: 1px solid #e5e5e5; border-radius: 4px; padding: 1.5rem;">
                    <strong style="display: block; margin-bottom: 1rem; font-size: 1.1rem;">{{ $audio.title }}</strong>
                    <audio controls style="width: 100%;">
                        <source src="{{ $audio.url }}" type="audio/mpeg">
                    </audio>
                </div>
                {{ end }}
            </div>
        </div>
    </section>
    {{ end }}

    <!-- Images Section - Full Width -->
    {{ if .Params.images }}
    <section style="margin: 3rem 0;">
        <div class="content-container">
            <h2 style="font-size: 1.75rem; font-weight: 600; margin-bottom: 2rem;">üì∑ Class Notes & Images</h2>
        </div>
        <div style="max-width: 1200px; margin: 0 auto; padding: 0 2rem;">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
                {{ range $image := .Params.images }}
                <div style="border: 1px solid #e5e5e5; border-radius: 4px; overflow: hidden;">
                    <img src="{{ $image.url }}" alt="{{ $image.caption }}" 
                         style="width: 100%; height: auto; display: block; cursor: pointer;"
                         class="class-image" loading="lazy">
                    {{ if $image.caption }}
                    <p style="padding: 1rem; margin: 0; border-top: 1px solid #e5e5e5; font-size: 0.875rem; color: #666;">{{ $image.caption }}</p>
                    {{ end }}
                </div>
                {{ end }}
            </div>
        </div>
    </section>
    {{ end }}

    <!-- Documents Section - Full Width -->
    {{ if .Params.documents }}
    <section style="margin: 3rem 0;">
        <div class="content-container">
            <h2 style="font-size: 1.75rem; font-weight: 600; margin-bottom: 2rem;">üìÑ Documents & Files</h2>
        </div>
        <div style="max-width: 1200px; margin: 0 auto; padding: 0 2rem;">
            <div style="display: grid; gap: 1rem;">
                {{ range $doc := .Params.documents }}
                <a href="{{ $doc.url }}" 
                   target="_blank"
                   rel="noopener noreferrer"
                   style="display: flex; align-items: center; gap: 1rem; padding: 1.25rem; border: 1px solid #e5e5e5; border-radius: 4px; text-decoration: none; color: inherit; transition: background 0.2s;"
                   onmouseover="this.style.background='#f5f5f5'" 
                   onmouseout="this.style.background='transparent'">
                    <span style="font-size: 1.5rem;">
                        {{ if eq $doc.type "pdf" }}üìï
                        {{ else if eq $doc.type "pptx" }}üìä
                        {{ else if eq $doc.type "docx" }}ÔøΩ
                        {{ else if eq $doc.type "xlsx" }}üìà
                        {{ else }}ÔøΩüìÑ{{ end }}
                    </span>
                    <div style="flex: 1;">
                        <div style="font-weight: 500;">{{ $doc.title }}</div>
                        {{ if $doc.description }}
                        <div style="color: #666; font-size: 0.875rem; margin-top: 0.25rem;">{{ $doc.description }}</div>
                        {{ end }}
                    </div>
                    <span style="color: #666; font-size: 0.875rem; white-space: nowrap;">
                        {{ if $doc.size }}{{ $doc.size }} ‚Ä¢ {{ end }}Download ‚Üí
                    </span>
                </a>
                {{ end }}
            </div>
        </div>
    </section>
    {{ end }}

    <!-- Class Content -->
    {{ if .Content }}
    <section style="margin: 3rem 0; padding: 2rem 0; border-top: 1px solid #e5e5e5;">
        <div style="max-width: 1200px; margin: 0 auto; padding: 0 2rem;">
            <div class="article e-content">
                {{ .Content }}
            </div>
        </div>
    </section>
    {{ end }}

    <!-- Post Footer -->
    <div class="content-container">
        <div class="article">
            <footer class="post-footer">
                <nav class="post-navigation">
                    {{ with .PrevInSection }}
                    <a href="{{ .Permalink }}" class="post-nav-item post-nav-prev">
                        <span class="nav-direction">‚Üê Previous</span>
                        <span class="nav-title">{{ .Title }}</span>
                    </a>
                    {{ else }}
                    <div class="post-nav-item post-nav-placeholder"></div>
                    {{ end }}
                    
                    <a href="{{ .Parent.Permalink }}" class="post-nav-item" style="text-align: center;">
                        <span class="nav-direction">‚Üë Back to</span>
                        <span class="nav-title">{{ .Parent.Title }}</span>
                    </a>
                    
                    {{ with .NextInSection }}
                    <a href="{{ .Permalink }}" class="post-nav-item post-nav-next">
                        <span class="nav-direction">Next ‚Üí</span>
                        <span class="nav-title">{{ .Title }}</span>
                    </a>
                    {{ else }}
                    <div class="post-nav-item post-nav-placeholder"></div>
                    {{ end }}
                </nav>
            </footer>
        </div>
    </div>
</article>

<script>
// Simple image lightbox
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.class-image').forEach(img => {
        img.addEventListener('click', function() {
            const overlay = document.createElement('div');
            overlay.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);display:flex;align-items:center;justify-content:center;z-index:9999;cursor:pointer;padding:2rem;';
            overlay.innerHTML = `<img src="${this.src}" style="max-width:100%;max-height:100%;object-fit:contain;">`;
            overlay.onclick = () => overlay.remove();
            document.body.appendChild(overlay);
        });
    });
});
</script>
{{ end }}
